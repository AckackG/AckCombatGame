# Project: Ballistics - 文件结构说明

本文档简要介绍了项目中各个文件的作用和职责，便于快速理解架构。实际上以具体代码为先。

## 根目录
- **`index.html`**: 游戏的入口 HTML 文件。包含主菜单（Overlay）、游戏 Canvas 容器以及 UI 界面元素（按钮、HUD）。
- **`style.css`**: 全局样式表。定义了赛博朋克/战术终端风格的主菜单、游戏内 UI 布局以及 Canvas 的显示样式。
- **`main.js`**: JavaScript 入口文件。负责引入各个模块，启动游戏。

## mylibs/ (核心库与工具)
- **`game.js`**: 游戏核心引擎。
  - `Game`: 管理游戏循环 (Game Loop)、时间步进、FPS 统计和 UI 更新。
  - `World`: 管理游戏世界状态，包含实体数组、Quadtree 和 Canvas 渲染。
  - `Viewport`: **[新增]** 管理视口变换，处理坐标转换（屏幕 -> 世界）和滚轮缩放逻辑。
- **`config.js`**: 全局配置文件。导出常量（如 `targetFPS`）。
- **`utils.js`**: 通用工具函数库。包含数学计算（距离、角度）、FPS 队列类、以及全局武器统计类 (`WeaponStat`)。
- **`quadtree.js`**: 四叉树实现。用于空间分割，优化单位与单位、单位与子弹之间的碰撞检测性能。
- **`logic.js`**: 核心游戏逻辑。封装了造成伤害 (`deal_damage`) 和击杀结算 (`target_killed`) 的通用处理函数。
- **`btn_event.js`**: 输入事件管理。处理 DOM 按钮点击、鼠标在 Canvas 上的交互（放置单位、右键取消）以及滚轮缩放事件。
- **`weapons.js`**: 武器逻辑核心。定义了 `GunBasic`（射弹武器）、`InstaWeapon`（即时命中/近战）基类以及 `GunFactory`（武器工厂）。
- **`effects.js`**: 状态效果系统。定义了 `Effect` 基类和 `DOT`（持续伤害）类。
- **`CanvasTextPrompt.js`**: 视觉反馈渲染。用于绘制飘字（伤害数值）、简单的圆形粒子和爆炸效果。
- **`database.js`**: 武器数据库。负责渲染游戏内所有武器的详细数据，并处理主菜单与数据库视图之间的导航。
- **`sound_manager.js`**: 音效管理器。管理游戏中所有音效的加载和播放，使用对象池进行性能优化，并提供播放随机枪声音效的功能。
-  wave.js 管理游戏战役模式

## objects/ (游戏实体)
- **`obj_basic.js`**: 实体基类。定义了 `MoveableObject`（处理移动向量）、`EntityBasic`（单位基类）和 `BulletBasic`（子弹基类）。
- **`units.js`**: 单位具体实现。包含 `Unit`（通用单位）、`Fighter`（玩家单位）、`Turret`（炮塔）、`Monster`（怪物 AI）和 `Dummy`（靶子）。
- **`projectiles.js`**: 投射物具体实现。定义了 `Bullet` 类（包含物理运动、爆炸逻辑、曳光弹渲染）和 `BulletFactory`。
- **`battalion.js`**: 单位生成工厂。提供静态方法快速生成预设的单位组合（如步兵班、特种部队）。

## data/ (数据配置)
- **`weapons_data.js`**: 武器数据表。以 JSON 对象形式存储所有枪械的属性（伤害、射速、后坐力、弹道类型等）。

# 代码规范
- 请你以资深软件开发者和架构师的水平，根据我的修改要求进行更新。
- 除了我的要求，不要修复、优化其他无关的部分
- 不要删减修改任何我的代码里的旧注释
- 你的注释应简洁精炼。不要注释说增删改了哪里，注释应仅仅解释当前代码
- 如果你需要更多信息，请告诉我怎么做，不要假设和瞎猜
